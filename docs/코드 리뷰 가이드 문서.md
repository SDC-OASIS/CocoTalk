# [ê¹€ë¯¼ì •] ì½”ë“œ ë¦¬ë·°ìš© ê°€ì´ë“œ

- Java/Springì„ ì‚¬ìš©í•´ backend apië¥¼ ê°œë°œí•˜ì˜€ìŠµë‹ˆë‹¤.
- web/mobileì„ ë³„ë„ë¡œ ê´€ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤.
    - ì˜ˆë¥¼ ë“¤ì–´ ë™ì‹œ ë¡œê·¸ì¸ì„ ë§‰ëŠ” ê¸°ëŠ¥ì—ì„œ, ë‘ ëŒ€ì˜ ëª¨ë°”ì¼ ê¸°ê¸°ê°€ ë™ì‹œì— ê°™ì€ ìœ ì €ë¡œ ë¡œê·¸ì¸ ìƒíƒœë¡œ ìˆëŠ” ê±´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì›¹ê³¼ ëª¨ë°”ì¼ì€ ë™ì‹œì— ë¡œê·¸ì¸ ìƒíƒœì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
    AuthëŠ” Spring MVC ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.
    
    PushëŠ” Spring WebFlux ë¥¼ ì‹œë„í–ˆìŠµë‹ˆë‹¤.
    

---

# ğŸ“Œ ëª©ì°¨

- [Auth](#-auth)   
  - [application](#application)
  - [config](#config)
  - [contoller](#contoller)
  - [entity](#entity) 
  - [dto](#dto)
  - [exception](#exception)
  - [repository](#repository)
  - [service](#service)
  - [utils](#utils)
- [Push](#-push)   
  - [application](#application)
  - [config](#config)
  - [contoller](#contoller)
  - [dto](#dto)
  - [entity](#entity) 
  - [exception](#exception)
  - [repository](#repository)
  - [service](#service)
 
---

# ğŸ”“ Auth

## application

```
Cocotalk-Auth/
â”œâ”€â”€ README.md
â”œâ”€â”€ ...
â”œâ”€â”€src
â”‚   â”œâ”€â”€main
â”‚   â”‚   â””â”€â”€java
â”‚   â”‚       â””â”€â”€com
â”‚   â”‚           â””â”€â”€cocotalk
â”‚   â”‚               â””â”€â”€auth                   
â”‚   â”‚                   â””â”€â”€application
â”‚Â Â                       Â Â  â””â”€â”€ ClientArgumentResolver.java
```

**ClientArgumentResolver.java**

- ìš”ì²­ í•´ë”ë¥¼ í†µí•´ `user-agent`, `client ip` ì •ë³´ë¥¼ ì°¾ì•„ controlloerì—ì„œ í•„ìš”í•œ `ClientInfo.class` í˜•íƒœë¡œ ê°€ê³µí•©ë‹ˆë‹¤.

## config

```

â”‚Â Â                      â”œâ”€â”€ config
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ EmailConfig.java
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ RedisConfig.java
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ S3config.java
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ SpringDocConfig.java
â”‚Â Â                      â”‚Â Â  â””â”€â”€ WebConfig.java
```

**ì•„ë˜ì˜ ì„¤ì •ì´ ë“¤ì–´ìˆìŠµë‹ˆë‹¤**

- Eamil ì „ì†¡
- Redis
- Amazon S3
- Swagger Api Docs
- ArgumentResolver
- CORS

## contoller

```
â”‚Â Â                      â”œâ”€â”€ controller
â”‚Â Â                      â”‚Â Â  â””â”€â”€ AuthController.java
```

**AuthController.java**

- **ì¸ì¦** ê¸°ëŠ¥ê³¼ ê´€ë ¨ëœ API ìš”ì²­ì„ ë°›ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì…ë‹ˆë‹¤.
- ClientInfoê°€ ClientArgumentResolverë¥¼ í†µí•´ ë“¤ì–´ì˜µë‹ˆë‹¤.
- ClientInfoì•ˆì˜ ClientInTypeì€ webê³¼ mobileë¡œ êµ¬ë¶„í•˜ì—¬ ê´€ë¦¬í•˜ëŠ”ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

## entity

```
â”‚Â Â                      â”œâ”€â”€ entity
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ BaseTime.java
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ User.java
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ mapper
â”‚Â Â                      â”‚Â Â  â”‚Â Â  â””â”€â”€ UserMapper.java
```

**entity**

- DBì˜ í…Œì´ë¸”ê³¼ ë§¤í•‘ë˜ëŠ” ì—”í‹°í‹° í´ë˜ìŠ¤ì…ë‹ˆë‹¤.

**mapper**

- Entityì™€ Dtoê°„ì˜ ë§¤í•‘ì„ ë„ì™€ì¤ë‹ˆë‹¤. *(MapStruct ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©)*

## dto

```
â”‚Â Â                      â”œâ”€â”€ dto
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ common
â”‚Â Â                      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ payload
â”‚Â Â                      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ request
â”‚Â Â                      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ response
â”‚                       â”‚   â”‚   â”œâ”€â”€ ...
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ email
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ signin
â”‚Â Â                      â”‚Â Â  â””â”€â”€ signup
```

**common**

- ê³µí†µìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” dto ì…ë‹ˆë‹¤.
- **payload**
    - í† í°, ì—”í‹°í‹°ì˜ í•„ë“œ ë“± ë‚´ë¶€ì— ë‹´ê²¨ì§€ëŠ” í´ë˜ìŠ¤ ì…ë‹ˆë‹¤.
- **request**
    - API CALLì— ì‚¬ìš©ë˜ëŠ” Requestìš© í´ë˜ìŠ¤ ì…ë‹ˆë‹¤.
- **response**
    - `Response.java`
        - APIì—ì„œ ì‘ë‹µ ë¦¬í„´ì‹œ ResponseEntityì— ë‹´ì•„ ë³´ë‚´ëŠ” ì»¤ìŠ¤í…€ ì‘ë‹µ ëª¨ë¸ì…ë‹ˆë‹¤.
        - ë™ì¼í•œ í˜•íƒœë¡œ ê°’ì„ ë°˜í™˜í•˜ê¸° ìœ„í•´ ìˆìŠµë‹ˆë‹¤.
    - `ResponseStatus`
        - Responseì— ì‚¬ìš©ë˜ëŠ” ResponseStatus ì…ë‹ˆë‹¤.

**email**

- email ê´€ë ¨ apiì—ì„œ ì‚¬ìš©ë˜ëŠ” dto ì…ë‹ˆë‹¤.

**signin**

- ë¡œê·¸ì¸ ê´€ë ¨ apiì—ì„œ ì‚¬ìš©ë˜ëŠ” dto ì…ë‹ˆë‹¤.

**signup**

- íšŒì›ê°€ì… ê´€ë ¨ apiì—ì„œ ì‚¬ìš©ë˜ëŠ” dto ì…ë‹ˆë‹¤

## exception

```
â”‚Â Â                      â”œâ”€â”€ exception
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ CustomException.java
â”‚Â Â                      â”‚Â Â  â””â”€â”€ CustomExceptionHandler.java
```

**CustomException.java**

- Exception ë°œìƒ ì‹œ ****ì‘ë‹µì„ ì»¤ìŠ¤í…€í•˜ê¸° ìœ„í•œ ****CustomExceptionì…ë‹ˆë‹¤.

****CustomExceptionHandler.java****

- `@RestControllerAdvice` ë¥¼ í†µí•´ ë°œìƒí•œ Exceptionì„ catchí•˜ì—¬ ì²˜ë¦¬í•©ë‹ˆë‹¤.

## repository

```
â”‚Â Â                      â”œâ”€â”€ repository
â”‚Â Â                      â”‚Â Â  â””â”€â”€ UserRepository.java
```

JPAë¥¼ ì‚¬ìš©í•œ repository ì…ë‹ˆë‹¤.

## service

```
â”‚Â Â                      â”œâ”€â”€ service
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ AuthService.java
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ RedisService.java
â”‚Â Â                      â”‚Â Â  â””â”€â”€ S3Service.java
```

**AuthService.java**

- **ì¸ì¦** ê¸°ëŠ¥ê³¼ ê´€ë ¨ëœ ì„œë¹„ìŠ¤ ë©”ì„œë“œë“¤ì´ í¬í•¨ëœ í´ë˜ìŠ¤ ì…ë‹ˆë‹¤.

**S3Service.java**

- S3ì— ì´ë¯¸ì§€ íŒŒì¼ ì—…ë¡œë“œì™€ ê´€ë ¨ëœ ì„œë¹„ìŠ¤ ë©”ì„œë“œë“¤ì´ í¬í•¨ëœ í´ë˜ìŠ¤ ì…ë‹ˆë‹¤.

**RedisService**.**java**

- Refresh Tokenê³¼ email ì¸ì¦ ì½”ë“œì˜ ì €ì¥, ì‚­ì œ, ì¡°íšŒ ë“± Redis ê´€ë ¨ ì„œë¹„ìŠ¤ ë©”ì„œë“¤ì´ í¬í•¨ëœ í´ë˜ìŠ¤ ì…ë‹ˆë‹¤.

## utils

```
â”‚Â Â                  â””â”€â”€ utils
â”‚Â Â                      â”œâ”€â”€ JwtUtils.java
â”‚Â Â                      â””â”€â”€ **SHA256Utils.java
```

**JwtUtil.java**

- ì¸ì¦ì„ ìœ„í•œ Jwt ê´€ë ¨ ë©”ì„œë“œê°€ í¬í•¨ëœ í´ë˜ìŠ¤ ì…ë‹ˆë‹¤.

**SHA256Utils.java**

- ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”ì— ì‚¬ìš©ë˜ëŠ” ë©”ì†Œë“œê°€ í¬í•¨ëœ í´ë˜ìŠ¤ ì…ë‹ˆë‹¤.

---

# ğŸ—¨ Push

## application

```
Cocotalk-Push/
â”œâ”€â”€ README.md
â”œâ”€â”€ ...
â”œâ”€â”€src
â”‚   â”œâ”€â”€main
â”‚   â”‚   â””â”€â”€java
â”‚   â”‚       â””â”€â”€com
â”‚   â”‚           â””â”€â”€cocotalk
â”‚   â”‚               â””â”€â”€auth                   
â”‚   â”‚                   â””â”€â”€application
â”‚Â Â                       Â Â  â””â”€â”€ ClientArgumentResolver.java
```

**ClientArgumentResolver.java**

- ìš”ì²­ í•´ë”ë¥¼ í†µí•´ `user-agent`, `client ip` ì •ë³´ë¥¼ ì°¾ì•„ controlloerì—ì„œ í•„ìš”í•œ `ClientInfo.class` í˜•íƒœë¡œ ê°€ê³µí•©ë‹ˆë‹¤.

## config

```

â”‚Â Â                      â”œâ”€â”€ **config**
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ SpringDocConfig.java
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ WebClientConfig.java
â”‚Â Â                      â”‚Â Â  â””â”€â”€ WebConfig.java
```

**ì•„ë˜ì˜ ì„¤ì •ì´ ë“¤ì–´ìˆìŠµë‹ˆë‹¤**

- Swagger Api Docs
- API í˜¸ì¶œì„ ìœ„í•œ WebClient ì„¤ì •
- ArgumentResolver
- CORS

## contoller

```
â”‚Â Â                      â”œâ”€â”€ controller
â”‚Â Â                      â”‚Â Â  â””â”€â”€ DeviceController.java
```

**DeviceController.java**

- Device ê¸°ëŠ¥ê³¼ ê´€ë ¨ëœ API ìš”ì²­ì„ ë°›ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì…ë‹ˆë‹¤. 
(ì£¼ë¡œ ê¸°ê¸°ì˜ FCM TOKEN ê´€ë¦¬)
- ClientInfoê°€ ClientArgumentResolverë¥¼ í†µí•´ ë“¤ì–´ì˜µë‹ˆë‹¤.
- ClientInfoì•ˆì˜ ClientInTypeì€ webê³¼ mobileë¡œ êµ¬ë¶„í•˜ì—¬ ê´€ë¦¬í•˜ëŠ”ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

## dto

```
â”‚Â Â                      â”œâ”€â”€ dto
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ common
â”‚Â Â                      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ response
â”‚                       â”‚   â”‚   â”œâ”€â”€ ...
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ device
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ fcm
â”‚Â Â                      â”‚Â Â  â””â”€â”€ kafka
```

**common**

- ê³µí†µìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” dto ì…ë‹ˆë‹¤.
- **response**
    - `Response.java`
        - APIì—ì„œ ì‘ë‹µ ë¦¬í„´ì‹œ ResponseEntityì— ë‹´ì•„ ë³´ë‚´ëŠ” ì»¤ìŠ¤í…€ ì‘ë‹µ ëª¨ë¸ì…ë‹ˆë‹¤.
        - ë™ì¼í•œ í˜•íƒœë¡œ ê°’ì„ ë°˜í™˜í•˜ê¸° ìœ„í•´ ìˆìŠµë‹ˆë‹¤.
    - `ResponseStatus`
        - Responseì— ì‚¬ìš©ë˜ëŠ” ResponseStatus ì…ë‹ˆë‹¤.

**device**

- deviceê´€ë ¨ apiì—ì„œ ì‚¬ìš©ë˜ëŠ” dto ì…ë‹ˆë‹¤.

**fcm**

- `FCMMessage`
    - Firebase Cloud Messagingì— ë³´ë‚¼ í‘¸ì‹œ ìš”ì²­ì˜ bodyì— ë‹´ì„ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.

**kafka**

- `PushTopicDto`
    - kafkaì˜ push topicì—ì„œ ë°›ì•„ ì˜¬ push ìš”ì²­ì˜ dto ì…ë‹ˆë‹¤.
    - chat ì„œë²„ì—ì„œ ë™ì¼í•œ í˜•íƒœë¡œ kafkaì˜ push topicì— pubì„ í•˜ê³  ìˆìŠµë‹ˆë‹¤.

## entity

```
â”‚Â Â                      â”œâ”€â”€ entity
â”‚Â Â                      â”‚Â Â  â””â”€â”€ Device.java
```

**entity**

- DBì˜ í…Œì´ë¸”ê³¼ ë§¤í•‘ë˜ëŠ” ì—”í‹°í‹° í´ë˜ìŠ¤ì…ë‹ˆë‹¤.

## exception

```
â”‚Â Â                      â”œâ”€â”€ exception
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ CustomException.java
â”‚Â Â                      â”‚Â Â  â””â”€â”€ CustomExceptionHandler.java
```

**CustomException.java**

- Exception ë°œìƒ ì‹œ ****ì‘ë‹µì„ ì»¤ìŠ¤í…€í•˜ê¸° ìœ„í•œ ****CustomExceptionì…ë‹ˆë‹¤.

****CustomExceptionHandler.java****

- `@RestControllerAdvice` ë¥¼ í†µí•´ ë°œìƒí•œ Exceptionì„ catchí•˜ì—¬ ì²˜ë¦¬í•©ë‹ˆë‹¤.

## repository

```
â”‚Â Â                      â”œâ”€â”€ repository
â”‚Â Â                      â”‚Â Â  â””â”€â”€ UserRepository.java
```

R2DBCë¥¼ ì‚¬ìš©í•œ repository ì…ë‹ˆë‹¤.

## service

```
â”‚Â Â                      â”œâ”€â”€ service
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ DeviceService.java
â”‚Â Â                      â”‚Â Â  â”œâ”€â”€ FCMService.java
â”‚Â Â                      â”‚Â Â  â””â”€â”€ KafkaConsumer.java
```

**DeviceService.java**

- Deviceë¥¼ ê´€ë¦¬í•˜ëŠ” ë©”ì„œë“œë“¤ì´ í¬í•¨ëœ í´ë˜ìŠ¤ ì…ë‹ˆë‹¤.

**FCMService.java**

- Firebase Cloud Messagingì— í‘¸ì‹œ ìš”ì²­ì„ ë³´ë‚´ëŠ”ë° í•„ìš”í•œ ë©”ì„œë“œë“¤ì´ í¬í•¨ëœ í´ë˜ìŠ¤ ì…ë‹ˆë‹¤.

**KafkaConsumer**.**java**

- Kafkaì˜ push topicì—ì„œ push ìš”ì²­ì„ ê¸°ë‹¤ë¦¬ê³  ìˆë‹¤ê°€, í‘¸ì‹œ ìš”ì²­ì„ ë°›ìœ¼ë©´ fcmì„ ì´ìš©í•´ clientì—ê²Œ pushë¥¼ ë³´ëƒ…ë‹ˆë‹¤.
- push ìš”ì²­ì€ `PushTopicDto` í˜•íƒœë¡œ Chat ì„œë²„ì—ì„œ ë³´ëƒ…ë‹ˆë‹¤.
